<?xml version="1.0" encoding="UTF-8" ?>

<!-- DTD 선언 -->
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="document">
	<select id="seqDocu" resultType="String">
		SELECT DOCU_SEQ.NEXTVAL FROM DUAL
	</select>
	
	<insert id="docuWriteInsert" parameterType="docuWriteInsert">
		INSERT INTO DOCUMENT(DOCU_CODE
						   , DOCU_TYPE
						   , DOCU_YEAR
						   , DOCU_TITLE
						   , DOCU_CONTENT
						   , DOCU_STATUS
						   , DOCU_CHECK
						   , DOCU_DATE
						   , DOCU_EMP_CODE) VALUES ('DOCU'||TRIM(TO_CHAR(#{seqDocu},'000000'))
						   						  , #{docu_acc}
						   						  , SYSDATE+#{docu_keep}
						   						  , #{docu_title}
						   						  , #{docu_note}
						   						  , 'N'
						   						  , 'N'
						   						  , SYSDATE
						   						  , #{docu_emp_code})
	</insert>
	
	<select id="docuList" resultType="docuList" parameterType="string">
		SELECT *
  		  FROM (SELECT DL.DOCU_CODE
        		     , DL.DOCU_TYPE
           		     , DL.DOCU_TITLE
         		     , TO_CHAR(DL.DOCU_DATE, 'yyyy-mm-dd') AS DOCU_WDAT
          		     , TO_CHAR(DL.DOCU_DATE, 'hh:dd') AS DOCU_WHOUR
           		     , DL.DOCU_CHECK
          		     , DL.DOCU_EMP_CODE
       		      FROM DOCUMENT DL
    	          JOIN EMP_INFO EI ON (EI.EMP_INFO_EMP_NO = DL.DOCU_EMP_CODE)
     		      JOIN JOB_INFO JI ON (JI.JOB_INFO_CODE = EI.EMP_INFO_JOB_CODE)
      		     WHERE DL.DOCU_EMP_CODE = #{emp_info_emp_no}
   		         ORDER BY DL.DOCU_CODE DESC
     		   )
  	     WHERE ROWNUM &lt; 6
	</select>
</mapper>