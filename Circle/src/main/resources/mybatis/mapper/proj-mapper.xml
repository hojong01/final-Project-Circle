<?xml version="1.0" encoding="UTF-8" ?>

<!-- DTD 선언 -->
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- mapper라는 영역 안에 구문을 작성한다 - namespace : mapper간의 충돌을 방지 하기 위한 이름 (필수) -->
<mapper namespace="project">



<!--  proj list -->
	<select id="projMain" resultType="project"  parameterType="project">
select *
from project p
 join emp_info e on (p.pro_manager = e.emp_info_emp_no)
where pro_code in (select distinct iss_pro_code
                        from iss i
                        where iss_emp_no =  #{emp_no}
                        )
                        order by pro_code desc
	</select>
	
	<select id="projIssMain" resultType="project" parameterType="project">
select *
	from iss i
	join emp_info e on (i.iss_emp_no = e.emp_info_emp_no)
	join project p on (i.iss_pro_code = p.pro_code)
	join prog g on (i.iss_prog_code = g.prog_code)
	join situ s on (i.iss_situ_code = s.situ_code)
	where p.pro_code =  #{pro_code}
    order by i.iss_code desc
	</select>
	
	
	<!--  총 게시글 개수  -->
	<select id="projCount" resultType="int">
	select count(*)
	from project
	</select>
	
	
	<select id="projSelect" parameterType="projPaging"
		resultType="project">
		select *
		from (
		select rownum rn, a.*
		from (
		select *
		from project
		p
		join iss i on (p.pro_code = i.iss_pro_code)
		join emp_info e on (i.iss_emp_no = e.emp_info_emp_no)
		where i.iss_emp_no  = #{iss_emp_no}
		order by pro_code desc
		) a
		)
		where rn between #{start} and
		#{end}

	</select>
	
	
	<!-- iss 내 정보 얻기 -->
	
	<select id="empNo" resultType="string" parameterType="string">
	select emp_info_emp_no
	from emp_info
	where emp_info_emp_no = #{emp_no}
	</select>
	
	
	
<!-- 정치적 중립선 -->
	<select id="projKanban" resultType="project">
	select *
		from project pr
		join iss i on (i.iss_pro_code = pr.pro_code)
		join emp_info e on(i.iss_emp_no = e.emp_info_emp_no)
		join prog p on (i.iss_prog_code = p.prog_code)
		join situ s on (i.iss_situ_code = s.situ_code)
		order by pr.pro_code desc
	
	</select>


<select id="projTodo" resultType="project">
	select *
		from project pr
		join iss i on (i.iss_pro_code = pr.pro_code)
		join emp_info e on(i.iss_emp_no = e.emp_info_emp_no)
		join prog p on (i.iss_prog_code = p.prog_code)
		join situ s on (i.iss_situ_code = s.situ_code)
		order by pr.pro_code desc
	
	</select>
</mapper>